## weather-service

Необходимо разработать анализатор погоды. Нужно использовать сторонние API 
(например https://rapidapi.com/weatherapi/api/weatherapi-com). Приложение 
будет запрашивать погоду с заданной в настройках периодичностью по определенному городу.

Как это работает:

Приложение получает информацию о погоде в Минске от стороннего  API, по расписанию и  
сохраняет ее в БД.
(Город по которому запрашивается погода всегда один и тот же)

Первый endpoint должен в качестве ответа отдавать информацию о текущей 
погоде - наиболее актуальная информация, которая хранится в БД сервиса. 
В ответе должна содержаться следующая информация:

1) Температура
2) Скорость ветра в м/ч
3) Атмосферное давление в гектопаскалях или миллибарах
4) Влажность воздуха
5) Погодные условия (солнечно, облачно и т.д.)
6) Локация

Второй endpoint должен выдавать рассчитанную на основании имеющихся 
в сервисе данных информацию о среднесуточной температуре. Пользователь 
должен будет иметь возможность получить информацию за указанный период. 

Request 
{
“from”: “22-08-2021”,
“to”: “24-08-2021”
}
Response
{
“average_temp”: 10
// и другие 
}
 
Взаимодействие пользователя с приложением происходит через REST API.

## Требования

- Docker и Docker Compose должны быть установлены на целевой системе.
- Интернет-соединение для загрузки необходимых Docker-образов.

## Установка и настройка

1. Клонируйте репозиторий с приложением:

```
git clone https://github.com/AlekseyDevochko/weather
```

2. Перейдите в директорию проекта:

```
cd your-project
```

3. Откройте файл `docker-compose.yml` и убедитесь, что конфигурация соответствует вашим потребностям. Если требуется, внесите необходимые изменения в файл.

4. Запустите приложение с помощью команды:

```
docker-compose up -d
```

5. Откройте браузер и перейдите по адресу `http://localhost:8080`  для доступа к приложению.

## Конфигурация

Для файла `Dockerfile`:

- **FROM maven:3.8.4-openjdk-17 as builder**

  Используется базовый образ Maven с JDK 17 для сборки приложения.

- **WORKDIR /app**

  Устанавливает рабочую директорию внутри контейнера.

- **COPY . /app/.**

  Копирует все файлы и папки из текущего контекста сборки (обычно это директория, содержащая Dockerfile) внутрь контейнера в директорию `/app`.

- **RUN mvn -f /app/pom.xml clean package -Dmaven.test.skip=true**

  Выполняет сборку приложения с помощью Maven. Запускает команду `mvn clean package` с указанием пути к `pom.xml` файлу. Флаг `-Dmaven.test.skip=true` пропускает выполнение тестов при сборке.

- **FROM eclipse-temurin:17-jre-alpine**

  Используется базовый образ с JRE 17 для запуска приложения.

- **WORKDIR /app**

  Устанавливает рабочую директорию внутри контейнера.

- **COPY --from=builder /app/target/*.jar /app/*.jar**

  Копирует JAR-файл(ы) приложения из контейнера сборки (указанного как `builder`) внутрь контейнера для запуска.

- **EXPOSE 8181**

  Открывает порт 8181 в контейнере для внешнего доступа к приложению.

- **ENTRYPOINT ["java", "-jar", "/app/*.jar"]**

  Указывает команду, которая будет выполнена при запуске контейнера. Запускает Java-приложение, используя команду `java -jar` и указывает путь к JAR-файлу.

Для файла `docker-compose.yml`:

- **version: '3.9'**

  Указывает версию формата файла `docker-compose.yml`.

- **services:**

  Начало описания сервисов в файле `docker-compose.yml`.

- **db:**

  Название сервиса для базы данных.

- **image: mysql:8.2.0**

  Используется образ MySQL версии 8.2.0 для запуска контейнера базы данных.

- **restart: always**

  Контейнер будет автоматически перезапущен в случае ошибки или перезагрузки системы.

- **container_name: db**

  Задает имя контейнера базы данных.

- **ports:**

  Пробрасывает порт 3306 из контейнера базы данных на порт 3306 хостовой системы.

- **volumes:**

  Монтирует директорию `~apps/mysql` хостовой системы на путь `/var/lib/mysql` внутри контейнера базы данных.

- **environment:**

  Устанавливает переменные окружения для контейнера базы данных: `MYSQL_DATABASE`, `MYSQL_USER`, `MYSQL_PASSWORD`, `MYSQL_ROOT_PASSWORD`.

- **app:**

  Название сервиса для приложения.

- **build:**

  Определяет сборку образа для сервиса приложения.

- **context: .**

  Указывает путь к контексту сборки, который обычно является текущей директорией.

- **dockerfile: Dockerfile**

  Указывает путь к Dockerfile, который будет использоваться для сборки образа.

- **container_name: weather-app**

  Задает имя контейнера приложения.

- **image: weather:0.0.1**

  Устанавливает имя и версию образа для контейнера приложения.

- **ports:**

  Пробрасывает порт 8080 из контейнера приложения на порт 8080 хостовой системы.

- **depends_on:**

  Указывает зависимость сервиса приложения от сервиса базы данных. Это гарантирует, что контейнер базы данных будет запущен перед контейнером приложения.

- **environment:**

  Устанавливает переменные окружения для контейнера приложения: `SPRING_DATASOURCE_URL`, `SPRING_DATASOURCE_USERNAME`, `SPRING_DATASOURCE_PASSWORD`, `SPRING_JPA_HIBERNATE_DDL_AUTO`, `SPRING_PROFILES_ACTIVE`.

- **command: mvn spring-boot:run -Dspring.profiles.active=dev**

  Указывает команду, которая будет выполнена при запуске контейнера приложения. Запускает приложение Spring Boot с помощью команды `mvn spring-boot:run` и устанавливает активный профиль на `dev`.
## Использование

Получение информации о текущей погоде
http://localhost:8080/weather/current

Этот запрос предоставляет информацию о текущей погоде в Минске.

Запрос
HTTP метод: GET

Ответ
Пример ответа:

json

{
  "temperature": 25,
  "wind_speed": 10,
  "pressure": 1012,
  "humidity": 70,
  "weather_conditions": "солнечно",
  "location": "Минск"
}
Получение среднесуточной температуры за указанный период
http://localhost:8080/weather/average

Этот endpoint предоставляет информацию о среднесуточной температуре в Минске за указанный период.

Запрос
HTTP метод: POST

URL параметры:

startDate (обязательный) - начальная дата в формате "дд-мм-гггг"
endDate (обязательный) - конечная дата в формате "дд-мм-гггг"
Пример запроса:


POST /average_temperature?from=22-08-2021&to=24-08-2021
Ответ
Пример ответа:


{
  "average_temp": 10,
  // и другие данные
}
## Сопроводительная информация

Пользователь может взаимодействовать с приложением через REST API, отправляя GET и POST запросы на соответствующие адреса для получения 
информации о текущей погоде и среднесуточной температуре за указанный период.

Примеры запросов:

Получение информации о текущей погоде:

http://localhost:8080/weather/current

Получение среднесуточной температуры за указанный период:
http://localhost:8080/weather/average

POST /average_temperature?from=22-08-2021&to=24-08-2021

Примечание: Убедитесь, что ваше приложение запущено и имеет доступ к интернету и базе данных перед отправкой запросов.

## Вклад

Если разработка проекта открыта для вклада от других разработчиков, укажите инструкции по вкладу и взаимодействию с сообществом.

## Авторы

Девочко Алексей


